<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لعبة الطائرة - Crash Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #FF6B00;
            --secondary: #00C2FF;
            --success: #10B981;
            --danger: #EF4444;
            --warning: #F59E0B;
            --dark: #0F172A;
            --darker: #020617;
            --card-bg: rgba(30, 41, 59, 0.9);
            --text: #F1F5F9;
        }
        
        body {
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        /* Header */
        header {
            background: rgba(15, 23, 42, 0.95);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--primary);
            box-shadow: 0 4px 20px rgba(255, 107, 0, 0.2);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .balance-box {
            background: rgba(255, 107, 0, 0.1);
            padding: 0.8rem 1.5rem;
            border-radius: 15px;
            border: 1px solid var(--primary);
        }
        
        .balance-box span {
            color: var(--success);
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        /* Main Container */
        .main-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        /* Game Layout */
        .game-layout {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        /* Bet Panel */
        .bet-panel {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 107, 0, 0.3);
            height: fit-content;
        }
        
        .bet-panel h3 {
            color: var(--secondary);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid rgba(255, 107, 0, 0.3);
        }
        
        .bet-amount {
            margin-bottom: 1.5rem;
        }
        
        .bet-amount label {
            display: block;
            margin-bottom: 0.5rem;
            color: #94A3B8;
        }
        
        .amount-input {
            width: 100%;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--primary);
            border-radius: 10px;
            color: white;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .quick-bets {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin: 1rem 0;
        }
        
        .quick-bet {
            padding: 0.7rem;
            background: rgba(0, 194, 255, 0.1);
            border: 1px solid var(--secondary);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .quick-bet:hover {
            background: var(--secondary);
            transform: scale(1.05);
        }
        
        .auto-cashout {
            margin-top: 1.5rem;
        }
        
        .auto-cashout input {
            width: 100%;
            margin: 0.5rem 0;
        }
        
        .btn {
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            width: 100%;
            margin-top: 0.5rem;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        /* Game Area */
        .game-area {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(255, 107, 0, 0.3);
            text-align: center;
        }
        
        .multiplier-display {
            font-size: 5rem;
            font-weight: bold;
            margin: 1rem 0;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #currentMultiplier {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: all 0.1s;
        }
        
        .plane-container {
            height: 200px;
            position: relative;
            margin: 2rem 0;
            overflow: hidden;
            border-radius: 10px;
            background: linear-gradient(to bottom, #1e3c72 0%, #2a5298 100%);
        }
        
        #plane {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
            color: var(--primary);
            transition: bottom 0.1s linear;
        }
        
        .flight-path {
            position: absolute;
            bottom: 60px;
            left: 0;
            width: 100%;
            height: 2px;
            background: rgba(255, 107, 0, 0.5);
        }
        
        .game-controls {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .game-controls .btn {
            flex: 1;
        }
        
        /* History Panel */
        .history-panel {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 107, 0, 0.3);
            height: fit-content;
        }
        
        .history-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 1rem;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }
        
        .history-multiplier {
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--success);
        }
        
        .history-multiplier.crashed {
            color: var(--danger);
        }
        
        /* Bet History */
        .bets-history {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 2rem;
            border: 1px solid rgba(255, 107, 0, 0.3);
        }
        
        .bets-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .bets-table th {
            background: rgba(255, 107, 0, 0.2);
            padding: 1rem;
            text-align: right;
        }
        
        .bets-table td {
            padding: 0.8rem 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .profit {
            color: var(--success);
            font-weight: bold;
        }
        
        .loss {
            color: var(--danger);
            font-weight: bold;
        }
        
        /* Live Bets */
        .live-bets {
            background: rgba(0, 194, 255, 0.1);
            border-radius: 10px;
            padding: 1rem;
            margin-top: 1rem;
            border: 1px solid var(--secondary);
        }
        
        .live-bets-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
            color: var(--secondary);
        }
        
        .live-bets-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .live-bet-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Animations */
        @keyframes explosion {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.7; }
            100% { transform: scale(2); opacity: 0; }
        }
        
        .explosion {
            position: absolute;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, #FF6B00 0%, transparent 70%);
            border-radius: 50%;
            animation: explosion 0.5s ease-out;
            pointer-events: none;
        }
        
        @keyframes cashoutFlash {
            0%, 100% { background-color: transparent; }
            50% { background-color: rgba(16, 185, 129, 0.3); }
        }
        
        .cashout-flash {
            animation: cashoutFlash 0.5s ease-in-out 3;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .game-layout {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">
            <i class="fas fa-plane"></i>
            <span>Crash Plane</span>
        </div>
        
        <div class="user-info">
            <div class="balance-box">
                الرصيد: <span id="balance">10,000</span> نقطة
            </div>
            <div class="balance-box">
                الربح الإجمالي: <span id="totalProfit">0</span> نقطة
            </div>
            <button class="btn btn-secondary" style="width: auto; padding: 0.7rem 1.5rem;" onclick="addFunds()">
                <i class="fas fa-coins"></i> إضافة رصيد
            </button>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Game Layout -->
        <div class="game-layout">
            <!-- Left Panel: Bet Controls -->
            <div class="bet-panel">
                <h3><i class="fas fa-money-bill-wave"></i> لوحة الرهان</h3>
                
                <div class="bet-amount">
                    <label>مبلغ الرهان:</label>
                    <input type="number" id="betAmount" class="amount-input" value="100" min="10" step="10">
                    
                    <div class="quick-bets">
                        <div class="quick-bet" onclick="setBetAmount(50)">50</div>
                        <div class="quick-bet" onclick="setBetAmount(100)">100</div>
                        <div class="quick-bet" onclick="setBetAmount(500)">500</div>
                        <div class="quick-bet" onclick="setBetAmount(1000)">1,000</div>
                        <div class="quick-bet" onclick="setBetAmount(2000)">2,000</div>
                        <div class="quick-bet" onclick="setBetAmount(5000)">5,000</div>
                    </div>
                </div>
                
                <div class="auto-cashout">
                    <label>السحب التلقائي عند المضاعف:</label>
                    <input type="range" id="autoCashout" min="1.1" max="10" step="0.1" value="2">
                    <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                        <span id="autoCashoutValue">2.0x</span>
                        <span>10x</span>
                    </div>
                </div>
                
                <button id="placeBetBtn" class="btn btn-primary" onclick="placeBet()">
                    <i class="fas fa-plane"></i> بدأ الرحلة
                </button>
                
                <button id="cashoutBtn" class="btn btn-success" onclick="cashout()" disabled>
                    <i class="fas fa-hand-holding-usd"></i> سحب الآن
                </button>
                
                <button class="btn btn-danger" onclick="resetGame()">
                    <i class="fas fa-redo"></i> إعادة تعيين
                </button>
            </div>
            
            <!-- Center: Game Area -->
            <div class="game-area">
                <h2><i class="fas fa-fighter-jet"></i> لعبة الطائرة</h2>
                <p style="color: #94A3B8; margin-bottom: 1rem;">سحب قبل أن تنفجر الطائرة لربح المضاعف!</p>
                
                <div class="multiplier-display">
                    <span id="currentMultiplier">1.00x</span>
                </div>
                
                <div class="plane-container" id="planeContainer">
                    <div class="flight-path"></div>
                    <div id="plane">
                        <i class="fas fa-plane"></i>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: space-around; margin: 1rem 0; padding: 1rem; background: rgba(0,0,0,0.3); border-radius: 10px;">
                    <div>
                        <div style="color: #94A3B8;">أعلى ربح</div>
                        <div id="highestWin" style="font-size: 1.5rem; color: var(--success);">0</div>
                    </div>
                    <div>
                        <div style="color: #94A3B8;">الرهان النشط</div>
                        <div id="activeBet" style="font-size: 1.5rem; color: var(--primary);">0</div>
                    </div>
                    <div>
                        <div style="color: #94A3B8;">اللاعبون النشطون</div>
                        <div id="activePlayers" style="font-size: 1.5rem; color: var(--secondary);">0</div>
                    </div>
                </div>
                
                <div class="game-controls">
                    <button class="btn btn-secondary" onclick="autoBet()">
                        <i class="fas fa-robot"></i> رهان تلقائي
                    </button>
                    <button class="btn btn-secondary" onclick="doubleBet()">
                        <i class="fas fa-times-circle"></i> مضاعفة الرهان
                    </button>
                </div>
            </div>
            
            <!-- Right Panel: History -->
            <div class="history-panel">
                <h3><i class="fas fa-history"></i> تاريخ الرحلات</h3>
                <div class="history-list" id="crashHistory">
                    <!-- History will be populated by JS -->
                </div>
                
                <div class="live-bets">
                    <div class="live-bets-title">
                        <i class="fas fa-bolt"></i>
                        <span>الرهانات الحية</span>
                    </div>
                    <div class="live-bets-list" id="liveBets">
                        <!-- Live bets will appear here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bet History -->
        <div class="bets-history">
            <h3><i class="fas fa-list-alt"></i> سجل رهاناتك</h3>
            <table class="bets-table">
                <thead>
                    <tr>
                        <th>الوقت</th>
                        <th>المبلغ</th>
                        <th>المضاعف</th>
                        <th>السحب عند</th>
                        <th>الربح</th>
                        <th>الحالة</th>
                    </tr>
                </thead>
                <tbody id="userBetsHistory">
                    <!-- User bets will appear here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Game Instructions Modal -->
    <div id="instructions" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--card-bg); padding: 2rem; border-radius: 15px; border: 2px solid var(--primary); max-width: 500px; width: 90%; z-index: 1000; display: none;">
        <h3 style="color: var(--primary); margin-bottom: 1rem;"><i class="fas fa-info-circle"></i> كيفية اللعب</h3>
        <ol style="margin-right: 1.5rem; margin-bottom: 1.5rem;">
            <li style="margin-bottom: 0.5rem;">اختر مبلغ الرهان</li>
            <li style="margin-bottom: 0.5rem;">اضغط على "بدأ الرحلة"</li>
            <li style="margin-bottom: 0.5rem;">الطائرة تبدأ الطيران والمضاعف يزداد</li>
            <li style="margin-bottom: 0.5rem;">اسحب أموالك قبل أن تنفجر الطائرة</li>
            <li style="margin-bottom: 0.5rem;">إذا انفجرت قبل السحب، تخسر الرهان</li>
        </ol>
        <button class="btn btn-primary" onclick="closeInstructions()">بدأ اللعب</button>
    </div>

    <script>
        // بيانات اللعبة
        let balance = 10000;
        let totalProfit = 0;
        let currentBet = 0;
        let currentMultiplier = 1.00;
        let gameActive = false;
        let planePosition = 0;
        let crashPoint = 0;
        let gameInterval;
        let autoCashoutValue = 2.0;
        let isAutoCashout = false;
        
        // المحاكاة: لاعبين افتراضيين
        let activePlayers = 0;
        let highestWin = 0;
        
        // التاريخ
        let crashHistory = [];
        let userBets = [];
        let liveBets = [];
        
        // تهيئة الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            updateDisplay();
            generateInitialHistory();
            simulateLiveBets();
            showInstructions();
            
            // تحديث قيمة السحب التلقائي
            document.getElementById('autoCashout').addEventListener('input', function() {
                autoCashoutValue = parseFloat(this.value);
                document.getElementById('autoCashoutValue').textContent = autoCashoutValue.toFixed(1) + 'x';
            });
        });
        
        // عرض التعليمات
        function showInstructions() {
            document.getElementById('instructions').style.display = 'block';
        }
        
        function closeInstructions() {
            document.getElementById('instructions').style.display = 'none';
        }
        
        // تحديث العرض
        function updateDisplay() {
            document.getElementById('balance').textContent = balance.toLocaleString();
            document.getElementById('totalProfit').textContent = totalProfit.toLocaleString();
            document.getElementById('highestWin').textContent = highestWin.toLocaleString();
            document.getElementById('activeBet').textContent = currentBet.toLocaleString();
            document.getElementById('activePlayers').textContent = activePlayers;
        }
        
        // تعيين مبلغ الرهان
        function setBetAmount(amount) {
            document.getElementById('betAmount').value = amount;
            updateDisplay();
        }
        
        // وضع رهان
        function placeBet() {
            if (gameActive) {
                alert('اللعبة قيد التشغيل بالفعل!');
                return;
            }
            
            const betAmount = parseInt(document.getElementById('betAmount').value);
            
            if (betAmount < 10) {
                alert('الحد الأدنى للرهان هو 10 نقاط');
                return;
            }
            
            if (betAmount > balance) {
                alert('رصيدك غير كافي!');
                return;
            }
            
            // خصم الرهان
            balance -= betAmount;
            currentBet = betAmount;
            gameActive = true;
            
            // إعادة تعيين اللعبة
            currentMultiplier = 1.00;
            planePosition = 0;
            
            // إنشاء نقطة الانفجار (بين 1.1x و 20x)
            crashPoint = 1.1 + Math.random() * 18.9;
            
            // تحديث واجهة المستخدم
            document.getElementById('placeBetBtn').disabled = true;
            document.getElementById('cashoutBtn').disabled = false;
            document.getElementById('currentMultiplier').textContent = currentMultiplier.toFixed(2) + 'x';
            document.getElementById('plane').style.bottom = '20px';
            
            // إضافة رهان حي
            const liveBet = {
                id: Date.now(),
                player: 'أنت',
                amount: betAmount,
                multiplier: 1.00,
                cashoutAt: null
            };
            liveBets.push(liveBet);
            updateLiveBets();
            
            // محاكاة لاعبين جدد
            activePlayers = 3 + Math.floor(Math.random() * 10);
            
            // بدأ اللعبة
            gameInterval = setInterval(updateGame, 50);
            
            updateDisplay();
        }
        
        // تحديث اللعبة
        function updateGame() {
            if (!gameActive) return;
            
            // زيادة المضاعف
            const increment = 0.01 + (currentMultiplier * 0.001);
            currentMultiplier += increment;
            
            // تحريك الطائرة
            planePosition += 1;
            const planeElement = document.getElementById('plane');
            const containerHeight = document.getElementById('planeContainer').clientHeight;
            const newBottom = 20 + (planePosition * 0.5);
            
            if (newBottom < containerHeight - 50) {
                planeElement.style.bottom = newBottom + 'px';
            }
            
            // تحديث العرض
            document.getElementById('currentMultiplier').textContent = currentMultiplier.toFixed(2) + 'x';
            
            // تحديث الرهانات الحية
            updatePlayerMultipliers();
            
            // تحقق من السحب التلقائي
            if (isAutoCashout && currentMultiplier >= autoCashoutValue) {
                cashout();
                return;
            }
            
            // تحقق من الانفجار
            if (currentMultiplier >= crashPoint) {
                crash();
            }
        }
        
        // سحب الأموال
        function cashout() {
            if (!gameActive || currentBet === 0) return;
            
            // حساب الربح
            const profit = Math.floor(currentBet * currentMultiplier);
            balance += profit;
            totalProfit += (profit - currentBet);
            
            // تحديث أعلى ربح
            if (profit > highestWin) {
                highestWin = profit;
            }
            
            // إضافة للسجل
            userBets.unshift({
                time: new Date().toLocaleTimeString(),
                amount: currentBet,
                multiplier: currentMultiplier.toFixed(2),
                cashoutAt: currentMultiplier.toFixed(2),
                profit: profit - currentBet,
                status: 'فاز'
            });
            
            // إزالة من الرهانات الحية
            liveBets = liveBets.filter(bet => bet.player !== 'أنت');
            updateLiveBets();
            
            // عرض الرسالة
            alert(`مبروك! سحبت عند ${currentMultiplier.toFixed(2)}x\nالربح: ${(profit - currentBet).toLocaleString()} نقطة`);
            
            // تأثير بصرية
            document.getElementById('planeContainer').classList.add('cashout-flash');
            setTimeout(() => {
                document.getElementById('planeContainer').classList.remove('cashout-flash');
            }, 1500);
            
            // إعادة تعيين اللعبة
            resetGameState();
            updateHistory();
            updateUserBets();
            updateDisplay();
        }
        
        // انفجار الطائرة
        function crash() {
            if (!gameActive) return;
            
            clearInterval(gameInterval);
            
            // إضافة للتاريخ
            crashHistory.unshift({
                multiplier: crashPoint.toFixed(2),
                time: new Date().toLocaleTimeString()
            });
            
            // تحديث حالة الرهان
            userBets.unshift({
                time: new Date().toLocaleTimeString(),
                amount: currentBet,
                multiplier: currentMultiplier.toFixed(2),
                cashoutAt: 'انفجار',
                profit: -currentBet,
                status: 'خسر'
            });
            
            // تأثير الانفجار
            const planeContainer = document.getElementById('planeContainer');
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.style.left = '50%';
            explosion.style.top = document.getElementById('plane').style.bottom;
            planeContainer.appendChild(explosion);
            
            // إزالة الرهانات الحية
            liveBets = liveBets.filter(bet => bet.player !== 'أنت');
            updateLiveBets();
            
            // عرض الرسالة
            setTimeout(() => {
                alert(`انفجار! الطائرة انفجرت عند ${crashPoint.toFixed(2)}x\nخسارة: ${currentBet.toLocaleString()} نقطة`);
                
                // إعادة تعيين اللعبة
                resetGameState();
                updateHistory();
                updateUserBets();
                updateDisplay();
                
                // إزالة تأثير الانفجار
                explosion.remove();
            }, 500);
        }
        
        // إعادة تعيين حالة اللعبة
        function resetGameState() {
            gameActive = false;
            currentBet = 0;
            currentMultiplier = 1.00;
            planePosition = 0;
            
            document.getElementById('placeBetBtn').disabled = false;
            document.getElementById('cashoutBtn').disabled = true;
            document.getElementById('currentMultiplier').textContent = '1.00x';
            document.getElementById('plane').style.bottom = '20px';
            
            clearInterval(gameInterval);
            
            // محاكاة تغيير اللاعبين
            activePlayers = Math.floor(Math.random() * 5);
        }
        
        // إعادة تعيين كاملة
        function resetGame() {
            if (gameActive && confirm('هل تريد إلغاء الرهان الحالي؟')) {
                balance += currentBet; // استعادة الرهان
                resetGameState();
                updateDisplay();
            }
        }
        
        // تحديث تاريخ الانفجارات
        function updateHistory() {
            const historyList = document.getElementById('crashHistory');
            historyList.innerHTML = '';
            
            crashHistory.slice(0, 10).forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div>
                        <div style="font-size: 0.9rem; color: #94A3B8;">${item.time}</div>
                    </div>
                    <div class="history-multiplier crashed">${item.multiplier}x</div>
                `;
                historyList.appendChild(historyItem);
            });
        }
        
        // تحديث رهانات المستخدم
        function updateUserBets() {
            const historyBody = document.getElementById('userBetsHistory');
            historyBody.innerHTML = '';
            
            userBets.slice(0, 10).forEach(bet => {
                const row = document.createElement('tr');
                const profitClass = bet.profit >= 0 ? 'profit' : 'loss';
                const profitSign = bet.profit >= 0 ? '+' : '';
                
                row.innerHTML = `
                    <td>${bet.time}</td>
                    <td>${bet.amount.toLocaleString()}</td>
                    <td>${bet.multiplier}x</td>
                    <td>${bet.cashoutAt}x</td>
                    <td class="${profitClass}">${profitSign}${bet.profit.toLocaleString()}</td>
                    <td>
                        <span style="background: ${bet.status === 'فاز' ? 'var(--success)' : 'var(--danger)'}; 
                              padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.9rem;">
                            ${bet.status}
                        </span>
                    </td>
                `;
                historyBody.appendChild(row);
            });
        }
        
        // تحديث الرهانات الحية
        function updateLiveBets() {
            const liveBetsList = document.getElementById('liveBets');
            liveBetsList.innerHTML = '';
            
            liveBets.slice(0, 5).forEach(bet => {
                const betItem = document.createElement('div');
                betItem.className = 'live-bet-item';
                
                const playerName = bet.player === 'أنت' ? 
                    `<span style="color: var(--primary);">${bet.player}</span>` : 
                    bet.player;
                
                betItem.innerHTML = `
                    <div>${playerName}</div>
                    <div>${bet.amount.toLocaleString()}</div>
                    <div style="color: var(--warning);">${bet.multiplier.toFixed(2)}x</div>
                `;
                liveBetsList.appendChild(betItem);
            });
        }
        
        // تحديث مضاعفات اللاعبين
        function updatePlayerMultipliers() {
            liveBets.forEach(bet => {
                if (bet.player !== 'أنت') {
                    // زيادة عشوائية لمضاعفات اللاعبين الآخرين
                    bet.multiplier += 0.01 + Math.random() * 0.02;
                    
                    // بعض اللاعبين يسحبون عشوائياً
                    if (Math.random() < 0.02 && bet.multiplier > 1.5) {
                        liveBets = liveBets.filter(b => b.id !== bet.id);
                    }
                } else {
                    bet.multiplier = currentMultiplier;
                }
            });
            updateLiveBets();
        }
        
        // توليد تاريخ ابتدائي
        function generateInitialHistory() {
            for (let i = 0; i < 10; i++) {
                const multiplier = (1.1 + Math.random() * 5).toFixed(2);
                const time = new Date(Date.now() - i * 60000).toLocaleTimeString();
                crashHistory.push({ multiplier, time });
            }
            updateHistory();
        }
        
        // محاكاة رهانات حية
        function simulateLiveBets() {
            setInterval(() => {
                if (!gameActive) {
                    // إضافة لاعبين افتراضيين
                    const playerNames = ['محمد', 'أحمد', 'خالد', 'سارة', 'فاطمة', 'علي'];
                    const randomName = playerNames[Math.floor(Math.random() * playerNames.length)];
                    
                    if (liveBets.length < 8 && Math.random() < 0.3) {
                        liveBets.push({
                            id: Date.now() + Math.random(),
                            player: randomName,
                            amount: 50 + Math.floor(Math.random() * 500),
                            multiplier: 1.00,
                            cashoutAt: null
                        });
                        updateLiveBets();
                    }
                    
                    // إزالة بعض الرهانات
                    if (Math.random() < 0.2 && liveBets.length > 0) {
                        liveBets.shift();
                        updateLiveBets();
                    }
                }
            }, 3000);
        }
        
        // رهان تلقائي
        function autoBet() {
            isAutoCashout = !isAutoCashout;
            const btn = document.querySelector('.game-controls .btn:nth-child(1)');
            
            if (isAutoCashout) {
                btn.innerHTML = '<i class="fas fa-robot"></i> إيقاف التلقائي';
                btn.style.background = 'var(--danger)';
                alert(`تم تفعيل السحب التلقائي عند ${autoCashoutValue.toFixed(1)}x`);
            } else {
                btn.innerHTML = '<i class="fas fa-robot"></i> رهان تلقائي';
                btn.style.background = 'var(--secondary)';
                alert('تم إيقاف السحب التلقائي');
            }
        }
        
        // مضاعفة الرهان
        function doubleBet() {
            const currentAmount = parseInt(document.getElementById('betAmount').value);
            document.getElementById('betAmount').value = currentAmount * 2;
        }
        
        // إضافة رصيد
        function addFunds() {
            const amount = parseInt(prompt('كم نقطة تريد إضافتها؟'));
            if (amount && amount > 0) {
                balance += amount;
                updateDisplay();
                alert(`تم إضافة ${amount.toLocaleString()} نقطة لرصيدك`);
            }
        }
    </script>
</body>
</html>
